<p>작성자 : <%= @user.email %></p>

<p>제목 : <%= @article.title %></p>

<p>장소 : <%= @article.place %></p>

<p>내용 : <%= @article.content %></p>

<p>시작시간 : <%= @article.init_time %></p>

<p>종료시간 : <%= @article.fin_time %></p>

<p>현재 참여한 사람: </p>
<p><% @participants.each do |participant| %>
<%= participant %> | 
<% end %></p>


<% participant = [] %>
<% participant << current_user.email %>
<!-- 참가 기능 추가 / 참고로, 본인인 경우에는 게시물 작성 시 자동으로 참가 되도록 만들어야함.-->
<% if (@user.id != current_user.id) && (@participants & participant != participant) %>
<form action="/article/participate/<%= @article.id %>" method="post">
    <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
  <div class="form-group">
    <input type="hidden" name="user_id" class="form-control" value="<%= current_user.id %>">
    <input type="hidden" name="article_id" class="form-control" value="<%= @article.id %>">
  </div>
  <button type="submit" class="btn btn-primary">참가</button>
</form>
<% end %>

<!-- 취소 기능 추가 -->
<% if @participants & participant == participant %>
<form action="/article/participate_cancel/<%= @article.id %>" method="post">
    <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
  <div class="form-group">  
  <!-- 만약 게시물 작성인 본인이 참가 취소 할 경우 권한 넘겨주고 참여 취소 -->
  <% if @user.id == current_user.id %>
    <input type="text" name="passto_id" class="form-control" placeholder="게시물 권한을 넘겨줄 계정을 입력해주세요">
  <% end %>
    <input type="hidden" name="user_id" class="form-control" value="<%= current_user.id %>">
    <input type="hidden" name="article_id" class="form-control" value="<%= @article.id %>">
  </div>
  <button type="submit" class="btn btn-primary">취소</button>
</form>
<% end %>

<hr>

<%= link_to 'index 이동', '/' %>
<%= link_to '수정', "/article/edit/#{@article.id}" %>
<%= link_to '삭제', "/article/destroy/#{@article.id}", data: { confirm: "삭제하시겠습니까?" } %>
<%= link_to '완료(평가)', "/article/#{@article.id}/rating/new", data: { confirm: "모임이 끝나셨나요??\
확인 버튼을 누르시면 모임이 끝나고 평가 페이지로 넘어갑니다" } %>