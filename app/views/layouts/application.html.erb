<!doctype html>
<html lang="ko">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!--Rails tags-->
    <%= csrf_meta_tags %>
    <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>

    <!--icon library(ex. starring)-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <title>친그라운드</title>

    <style>
        /*율리우스 산스*/
        @import url('https://fonts.googleapis.com/css?family=Julius+Sans+One');
        /*나눔명조*/
        @import url('https://fonts.googleapis.com/css?family=Nanum+Myeongjo');
        /*스포카 한 산스*/
        @font-face{
        font-family: 'SpoqaHanSans-Regular';
        src: local('SpoqaHanSans-Regular'),
            url('./font/Spoqa Han Sans Regular.woff') format('woff');
        }
        @font-face{
        font-family: 'SpoqaHanSans-Light';
        src: local('SpoqaHanSans-Light'),
            url('./font/Spoqa Han Sans Light.woff') format('woff');
        }
        @font-face{
        font-family: 'SpoqaHanSans-Thin';
        src: local('SpoqaHanSans-Thin'),
            url('./font/Spoqa Han Sans Thin.woff') format('woff');
        }
        @font-face{
        font-family: 'SpoqaHanSans-Bold';
        src: local('SpoqaHanSans-Bold'),
            url('./font/Spoqa Han Sans Bold.woff') format('woff');
        }
        /* Sticky footer styles
        -------------------------------------------------- */
        html {
        position: relative;
        min-height: 100%;
        }
        body {
        /* Margin bottom by footer height */
        margin-bottom: 60px;
        font-family: 'Julius Sans One', sans-serif;
        }
        .footer {
        position: absolute;
        bottom: 0;
        width: 100%;
        /* Set the fixed height of the footer here */
        height: 60px;
        line-height: 60px; /* Vertically center the text there */
        background-color: #f5f5f5;
        }
        /* Custom page CSS
        -------------------------------------------------- */
        /* Not required for template or sticky footer method. */

        body > #section {
        padding: 60px 15px 0;
        font-family: 'Nanum Myeongjo', serif;
        }
        
        body > .container {
        font-family: 'SpoqaHanSans-Regular';
        }

        .footer > .container {
        padding-right: 15px;
        padding-left: 15px;
        font-family: 'SpoqaHanSans-Regular';
        text-align: center;
        }

        code {
        font-size: 80%;
        }

        h1, h2, h3, h4, h5, h6 {
            color: rgba(96, 118, 79, 1);
        }

        a {
            color: rgba(96, 118, 79, 1);
        }

        .nav-link:hover{
            background-color: rgba(255,255,255,0.2);
        }
        
        .checked {
        color: rgba(136, 176, 75);
        }
        
        #grid  div {
        width : 250px;
        height : auto;
        border : 1px solid #bbb;
        background-color : #eee;
        margin : 5px;
        padding : 3px;
        text-align: center;
        display: inline-block;
        }
        
        #grid p {
            font-size: 14px;
        }
        
    </style>
  </head>
  <body>
    <header>
    <!-- Fixed navbar -->
    <nav class="navbar navbar-expand-md navbar-light fixed-top" style="background-color: rgba(136, 176, 75)">
        <a class="navbar-brand" href="/" style="color:white;">CHINGROUND</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarCollapse">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item <%= 'active' if request.original_fullpath == '/' %>">
            <a class="nav-link" href="/" style="color:white;">홈</a>
            </li>
            <li class="nav-item <%= 'active' if request.original_fullpath == '/article' %>">
            <a class="nav-link" href="/article" style="color:white;">게시판</a>
            </li>
            <li class="nav-item">
            <!--나의 모임에서 종합 관리-->
            <a class="nav-link" href="#" style="color:white;">나의 모임</a>
            </li>
            <li class="nav-item <%= 'active' if request.original_fullpath == '/chatroom/show' %>">
            <a class="nav-link" href="/chatroom/show" style="color:white;">채팅</a>
            </li>
            <li class="nav-item <%= 'active' if request.original_fullpath == '/rating' %>">
            <a class="nav-link" href="/rating" style="color:white;">별점</a>
            </li>
            <% if user_signed_in? %>
            <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="dropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" style="color:white;"><%= current_user.email %></a>
            <div class="dropdown-menu" aria-labelledby="dropdown">
                <a class="dropdown-item" href="/mypage">마이페이지</a>
                <a class="dropdown-item" href="<%= edit_user_registration_path %>">계정관리</a>
                <%= link_to "로그아웃", destroy_user_session_path, method: :delete, data: { confirm: "로그아웃 하시겠습니까?" }, class: 'dropdown-item' %>
            </div>
            </li>
            <% else %>
            <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="dropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" style="color:white;">로그인/회원가입</a>
            <div class="dropdown-menu" aria-labelledby="dropdown">
                <a class="dropdown-item" href="<%= new_user_session_path %>">로그인</a>
                <a class="dropdown-item" href="<%= new_user_registration_path %>">회원가입</a>
            </div>
            <% end %>
        </ul>
        <form class="form-inline mt-2 mt-md-0">
            <input class="form-control mr-sm-2" type="text" placeholder="제목/내용/장소..." aria-label="Search">
            <button class="btn btn-outline-light my-2 my-sm-0" type="submit">찾기</button>
        </form>
        </div>
    </nav>
    </header>

    <!-- Begin page content -->
    <main role="main" id="section" style="width:75%; height:800px; display:inline-block; padding:20px 20px 20px 20px; margin-top:60px;">
        <%= render partial: "shared/flash_messages", flash: flash %>
        <%= yield %>
    </main>
    
    <% if user_signed_in? %>
    <div class="container" style="width:23%; border:1px solid slategray; float:right; text-align: center; margin: 60px 10px 10px 10px;">
    <h5>사용자: <%= current_user.email %></h5>
      <h6><% my_avg = RatingController.avg_rating(current_user.id) %></h6>
      <p>별점: <%= my_avg %>
        <span class="fa fa-star <%= "checked" if my_avg >= 1 %>"></span>
        <span class="fa fa-star <%= "checked" if my_avg >= 2 %>"></span>
        <span class="fa fa-star <%= "checked" if my_avg >= 3 %>"></span>
        <span class="fa fa-star <%= "checked" if my_avg >= 4 %>"></span>
        <span class="fa fa-star <%= "checked" if my_avg >= 5 %>"></span></p>
      <p>현재 참여 중</p>
      <table class="table table-hover">
        <thead>
          <tr>
            <th scope="col">제목</th>
            <th scope="col">작성자</th>
            <th scope="col">관리</th>
          </tr>
        </thead>
        <tbody>
          <%# ????.each do |a| %>
          <tr>
            <td><%#= article.title %></td>
            <td><%#= article.user.email %></td>
            <td><%#= link_to '보기', "/article/show/#{a.id}" %></td>
          </tr>
          <%# end %>
          <!-- ArticleUser 모델로 본인이 참여한 것 중 진행중인 것 show-->
        </tbody>
      </table>
    </div>
    <% end %>

    <!--footer-->
    <footer class="footer">
    <div class="container">
        <span class="text-muted">친구를 만드는 운동장 - "친그라운드"</span>
    </div>
    </footer>
  </body>
</html>