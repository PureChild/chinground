<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Chinground</title>
    <%= csrf_meta_tags %>
    <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %>
    <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>
    <!--icon library(ex. starring)-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>

  <body>
    <!-- Fixed navbar -->
  <div class="container navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/">친그라운드</a>
      </div>
      <div class="navbar-collapse collapse">
        <ul class="nav navbar-nav">
          <li class=<%= 'active' if request.original_fullpath == '/'  %>><%= link_to "홈", root_path %></li>
          <li class=<%= 'active' if request.original_fullpath == '/article' %>><%= link_to "게시글", "/article" %></li>
          <li class=<%= 'active' if request.original_fullpath == '/chatroom/show' %>><%= link_to "채팅방", "/chatroom/show" %></li>
          <li class=<%= 'active' if request.original_fullpath == '/rating' %>><%= link_to "별점", "/rating" %></li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
          <% if user_signed_in? %>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown"><%= current_user.email %> <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><%= link_to "마이페이지", "/rating" %></li>
                <li><%= link_to "계정 수정", edit_user_registration_path %></li>
                <li><%= link_to "로그아웃", destroy_user_session_path, method: :delete, data: { confirm: "로그아웃 하시겠습니까?" } %></li>
              </ul>
            </li>
          <% else %>
            <li><%= link_to "로그인", new_user_session_path %></li>
            <li><%= link_to "회원가입", new_user_registration_path %></li>
          <% end %>
        </ul>
      </div>
    </div>
  </div>          
    
  <div class="container">
    <!-- falsh message rendering-->
    <%= render partial: "shared/flash_messages", flash: flash %>
    <div id="section" style="width:80%; display:inline-block;">
      <%= yield %>
    </div>
    <% if user_signed_in? %>
    <div id="aside" style="width:18%; border:1px solid slategray; float:right; text-align: center;">
      <h4>사용자: <%= current_user.email %></h4>
      <% my_avg = RatingController.avg_rating(current_user.id) %>
      <p>별점: <%= my_avg %>
        <span class="fa fa-star <%= "checked" if my_avg >= 1 %>"></span>
        <span class="fa fa-star <%= "checked" if my_avg >= 2 %>"></span>
        <span class="fa fa-star <%= "checked" if my_avg >= 3 %>"></span>
        <span class="fa fa-star <%= "checked" if my_avg >= 4 %>"></span>
        <span class="fa fa-star <%= "checked" if my_avg >= 5 %>"></span></p>
      <p>현재 참여 중</p>
      <table class="table table-hover">
        <thead>
          <tr>
            <th scope="col">제목</th>
            <th scope="col">작성자</th>
            <th scope="col">관리</th>
          </tr>
        </thead>
        <tbody>
          <%# ????.each do |a| %>
          <tr>
            <td><%#= article.title %></td>
            <td><%#= article.user.email %></td>
            <td><%#= link_to '보기', "/article/show/#{a.id}" %></td>
          </tr>
          <%# end %>
          <!-- ArticleUser 모델로 본인이 참여한 것 중 진행중인 것 show-->
        </tbody>
      </table>
    </div>
    <% end %>
  </div>
  <div class="footer">
    
  </div>
  
  </body>
</html>
